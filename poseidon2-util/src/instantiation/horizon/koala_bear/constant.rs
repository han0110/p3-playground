use crate::{RoundConstants, instantiation::horizon::MatDiagMinusOne};
use p3_koala_bear::KoalaBear;

pub const SBOX_DEGREE: u64 = 3;

pub const HALF_FULL_ROUNDS: usize = 4;

pub const fn partial_round<const WIDTH: usize>() -> usize {
    match WIDTH {
        16 => 20,
        24 => 23,
        _ => unimplemented!(),
    }
}

#[rustfmt::skip]
pub const RC16: RoundConstants<KoalaBear, 16, HALF_FULL_ROUNDS, { partial_round::<16>() }> = RoundConstants {
    beginning_full_round_constants: KoalaBear::new_2d_array([
        [0x7ee56a48, 0x11367045, 0x12e41941, 0x7ebbc12b, 0x1970b7d5, 0x662b60e8, 0x3e4990c6, 0x679f91f5, 0x350813bb, 0x00874ad4, 0x28a0081a, 0x18fa5872, 0x5f25b071, 0x5e5d5998, 0x5e6fd3e7, 0x5b2e2660],
        [0x6f1837bf, 0x3fe6182b, 0x1edd7ac5, 0x57470d00, 0x43d486d5, 0x1982c70f, 0x0ea53af9, 0x61d6165b, 0x51639c00, 0x2dec352c, 0x2950e531, 0x2d2cb947, 0x08256cef, 0x1a0109f6, 0x1f51faf3, 0x5cef1c62],
        [0x3d65e50e, 0x33d91626, 0x133d5a1e, 0x0ff49b0d, 0x38900cd1, 0x2c22cc3f, 0x28852bb2, 0x06c65a02, 0x7b2cf7bc, 0x68016e1a, 0x15e16bc0, 0x5248149a, 0x6dd212a0, 0x18d6830a, 0x5001be82, 0x64dac34e],
        [0x5902b287, 0x426583a0, 0x0c921632, 0x3fe028a5, 0x245f8e49, 0x43bb297e, 0x7873dbd9, 0x3cc987df, 0x286bb4ce, 0x640a8dcd, 0x512a8e36, 0x03a4cf55, 0x481837a2, 0x03d6da84, 0x73726ac7, 0x760e7fdf],
    ]),
    partial_round_constants: KoalaBear::new_array([0x54dfeb5d, 0x7d40afd6, 0x722cb316, 0x106a4573, 0x45a7ccdb, 0x44061375, 0x154077a5, 0x45744faa, 0x4eb5e5ee, 0x3794e83f, 0x47c7093c, 0x5694903c, 0x69cb6299, 0x373df84c, 0x46a0df58, 0x46b8758a, 0x3241ebcb, 0x0b09d233, 0x1af42357, 0x1e66cec2]),
    ending_full_round_constants: KoalaBear::new_2d_array([
        [0x43e7dc24, 0x259a5d61, 0x27e85a3b, 0x1b9133fa, 0x343e5628, 0x485cd4c2, 0x16e269f5, 0x165b60c6, 0x25f683d9, 0x124f81f9, 0x174331f9, 0x77344dc5, 0x5a821dba, 0x5fc4177f, 0x54153bf5, 0x5e3f1194],
        [0x3bdbf191, 0x088c84a3, 0x68256c9b, 0x3c90bbc6, 0x6846166a, 0x03f4238d, 0x463335fb, 0x5e3d3551, 0x6e59ae6f, 0x32d06cc0, 0x596293f3, 0x6c87edb2, 0x08fc60b5, 0x34bcca80, 0x24f007f3, 0x62731c6f],
        [0x1e1db6c6, 0x0ca409bb, 0x585c1e78, 0x56e94edc, 0x16d22734, 0x18e11467, 0x7b2c3730, 0x770075e4, 0x35d1b18c, 0x22be3db5, 0x4fb1fbb7, 0x477cb3ed, 0x7d5311c6, 0x5b62ae7d, 0x559c5fa8, 0x77f15048],
        [0x3211570b, 0x490fef6a, 0x77ec311f, 0x2247171b, 0x4e0ac711, 0x2edf69c9, 0x3b5a8850, 0x65809421, 0x5619b4aa, 0x362019a7, 0x6bf9d4ed, 0x5b413dff, 0x617e181e, 0x5e7ab57b, 0x33ad7833, 0x3466c7ca],
    ]),
};

#[rustfmt::skip]
pub const RC24: RoundConstants<KoalaBear, 24, HALF_FULL_ROUNDS, { partial_round::<24>() }> = RoundConstants {
    beginning_full_round_constants: KoalaBear::new_2d_array([
        [0x1d0939dc, 0x6d050f8d, 0x628058ad, 0x2681385d, 0x3e3c62be, 0x032cfad8, 0x5a91ba3c, 0x015a56e6, 0x696b889c, 0x0dbcd780, 0x5881b5c9, 0x2a076f2e, 0x55393055, 0x6513a085, 0x547ac78f, 0x4281c5b8, 0x3e7a3f6c, 0x34562c19, 0x2c04e679, 0x0ed78234, 0x5f7a1aa9, 0x0177640e, 0x0ea4f8d1, 0x15be7692],
        [0x6eafdd62, 0x71a572c6, 0x72416f0a, 0x31ce1ad3, 0x2136a0cf, 0x1507c0eb, 0x1eb6e07a, 0x3a0ccf7b, 0x38e4bf31, 0x44128286, 0x6b05e976, 0x244a9b92, 0x6e4b32a8, 0x78ee2496, 0x4761115b, 0x3d3a7077, 0x75d3c670, 0x396a2475, 0x26dd00b4, 0x7df50f59, 0x0cb922df, 0x0568b190, 0x5bd3fcd6, 0x1351f58e],
        [0x52191b5f, 0x119171b8, 0x1e8bb727, 0x27d21f26, 0x36146613, 0x1ee817a2, 0x71abe84e, 0x44b88070, 0x5dc04410, 0x2aeaa2f6, 0x2b7bb311, 0x6906884d, 0x0522e053, 0x0c45a214, 0x1b016998, 0x479b1052, 0x3acc89be, 0x0776021a, 0x7a34a1f5, 0x70f87911, 0x2caf9d9e, 0x026aff1b, 0x2c42468e, 0x67726b45],
        [0x09b6f53c, 0x73d76589, 0x5793eeb0, 0x29e720f3, 0x75fc8bdf, 0x4c2fae0e, 0x20b41db3, 0x7e491510, 0x2cadef18, 0x57fc24d6, 0x4d1ade4a, 0x36bf8e3c, 0x3511b63c, 0x64d8476f, 0x732ba706, 0x46634978, 0x0521c17c, 0x5ee69212, 0x3559cba9, 0x2b33df89, 0x653538d6, 0x5fde8344, 0x4091605d, 0x2933bdde],
    ]),
    partial_round_constants: KoalaBear::new_array([0x1395d4ca, 0x5dbac049, 0x51fc2727, 0x13407399, 0x39ac6953, 0x45e8726c, 0x75a7311c, 0x599f82c9, 0x702cf13b, 0x026b8955, 0x44e09bbc, 0x2211207f, 0x5128b4e3, 0x591c41af, 0x674f5c68, 0x3981d0d3, 0x2d82f898, 0x707cd267, 0x3b4cca45, 0x2ad0dc3c, 0x0cb79b37, 0x23f2f4e8, 0x3de4e739]),
    ending_full_round_constants: KoalaBear::new_2d_array([
        [0x7d232359, 0x389d82f9, 0x259b2e6c, 0x45a94def, 0x0d497380, 0x5b049135, 0x3c268399, 0x78feb2f9, 0x300a3eec, 0x505165bb, 0x20300973, 0x2327c081, 0x1a45a2f4, 0x5b32ea2e, 0x2d5d1a70, 0x053e613e, 0x5433e39f, 0x495529f0, 0x1eaa1aa9, 0x578f572a, 0x698ede71, 0x5a0f9dba, 0x398a2e96, 0x0c7b2925],
        [0x2e6b9564, 0x026b00de, 0x7644c1e9, 0x5c23d0bd, 0x3470b5ef, 0x6013cf3a, 0x48747288, 0x13b7a543, 0x3eaebd44, 0x0004e60c, 0x1e8363a2, 0x2343259a, 0x69da0c2a, 0x06e3e4c4, 0x1095018e, 0x0deea348, 0x1f4c5513, 0x4f9a3a98, 0x3179112b, 0x524abb1f, 0x21615ba2, 0x23ab4065, 0x1202a1d1, 0x21d25b83],
        [0x6ed17c2f, 0x391e6b09, 0x5e4ed894, 0x6a2f58f2, 0x5d980d70, 0x3fa48c5e, 0x1f6366f7, 0x63540f5f, 0x6a8235ed, 0x14c12a78, 0x6edde1c9, 0x58ce1c22, 0x718588bb, 0x334313ad, 0x7478dbc7, 0x647ad52f, 0x39e82049, 0x6fee146a, 0x082c2f24, 0x1f093015, 0x30173c18, 0x53f70c0d, 0x6028ab0c, 0x2f47a1ee],
        [0x26a6780e, 0x3540bc83, 0x1812b49f, 0x5149c827, 0x631dd925, 0x001f2dea, 0x7dc05194, 0x3789672e, 0x7cabf72e, 0x242dbe2f, 0x0b07a51d, 0x38653650, 0x50785c4e, 0x60e8a7e0, 0x07464338, 0x3482d6e1, 0x08a69f1e, 0x3f2aff24, 0x5814c30d, 0x13fecab2, 0x61cb291a, 0x68c8226f, 0x5c757eea, 0x289b4e1e],
    ]),
};

impl MatDiagMinusOne<16> for KoalaBear {
    const MAT_DIAG_M_1: [Self; 16] = Self::new_array([
        0x1c9a12f1, 0x3f6fd40c, 0x0e1d4ec3, 0x1361c64c, 0x09a8f46f, 0x03d23a3f, 0x109ad28f,
        0x28c2fb87, 0x3b6498f1, 0x74d8be56, 0x6a4277d1, 0x18c2b3d3, 0x6252c30b, 0x07cc255f,
        0x209fe15a, 0x52a55fab,
    ]);
}

impl MatDiagMinusOne<24> for KoalaBear {
    const MAT_DIAG_M_1: [Self; 24] = Self::new_array([
        0x731b17fc, 0x201359bc, 0x22bf6498, 0x610f1a28, 0x3c73aa44, 0x6a092598, 0x1c7cb702,
        0x79533458, 0x7ef62d85, 0x5ab925aa, 0x67722ab0, 0x33ca4cfe, 0x007f7dcd, 0x0eeac41d,
        0x4724bea6, 0x45eaf64e, 0x21a6c90e, 0x094b414f, 0x0d94262f, 0x18712c2f, 0x3a470337,
        0x6eba771f, 0x487827c7, 0x77013a6c,
    ]);
}
